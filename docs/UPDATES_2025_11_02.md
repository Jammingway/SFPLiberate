# Epic Plan Updates - November 2, 2025

## üéâ Summary of Changes

Based on your feedback, I've updated the Next.js rewrite epic plan with the following improvements:

### ‚úÖ 1. Feature Flags Instead of Separate Branches

**Old Approach:**
- Separate branches: `feature/nextjs-standalone` and `feature/nextjs-appwrite`
- Risk of divergence and merge conflicts

**New Approach:**
- **Single `main` branch** with feature flags
- Environment variables control deployment mode:
  - `DEPLOYMENT_MODE=standalone` ‚Üí Docker build
  - `DEPLOYMENT_MODE=appwrite` ‚Üí Static export
  - `NEXT_PUBLIC_ENABLE_AUTH=true/false` ‚Üí Auth on/off
- No branch divergence, easier maintenance

**Implementation:**
```typescript
// lib/features.ts
export const features = {
  isAppwriteMode: process.env.NEXT_PUBLIC_DEPLOYMENT_MODE === 'appwrite',
  isStandaloneMode: process.env.NEXT_PUBLIC_DEPLOYMENT_MODE === 'standalone',
  enableAuth: process.env.NEXT_PUBLIC_ENABLE_AUTH === 'true',
  bleProxyEndpoint: process.env.NEXT_PUBLIC_BLE_PROXY_ENDPOINT || '',
} as const;
```

### ‚úÖ 2. Standalone BLE Proxy Service (Bonus Feature)

Created specification for a **standalone BLE proxy microservice** Docker container:

**Purpose:**
- Enables iOS/Safari users to use the public Appwrite UI
- Runs on user's local machine with Bluetooth access
- Hybrid architecture: public frontend + local BLE proxy + cloud API

**Key Features:**
- Lightweight (~50MB vs ~200MB full backend)
- One-command Docker setup
- Auto-detects local IP and displays WebSocket URL
- Configurable endpoint in Next.js Settings page
- Works with both deployment modes

**User Flow:**
1. User runs: `docker run -p 8081:8081 ghcr.io/.../sfpliberate-ble-proxy`
2. Container displays: `ws://192.168.1.100:8081/ble/ws`
3. User opens Appwrite UI on iOS Safari
4. User enters endpoint in Settings ‚Üí BLE Proxy Config
5. User connects to local SFP Wizard device via proxy!

**Documentation:**
- [Standalone BLE Proxy Service Spec](STANDALONE_BLE_PROXY_SERVICE.md)

### ‚úÖ 3. GitHub Issues Instead of Project Board

**Old Approach:**
- GitHub Project board for tracking

**New Approach:**
- **GitHub Issues** with:
  - Parent epic issue (EPIC-001)
  - 25 child story issues + 1 bonus feature
  - Dependencies via `Depends on: #123` syntax
  - Blockers and tags
  - Issue templates for consistency

**Issue Templates Created:**
- `.github/ISSUE_TEMPLATE/epic.yml` - For creating epics
- `.github/ISSUE_TEMPLATE/story.yml` - For creating stories
- `.github/ISSUE_TEMPLATE/config.yml` - Template configuration

**Example Issues Created:**
- `.github/issues/EPIC-001-nextjs-rewrite.md` - Parent epic
- `.github/issues/STORY-001-project-scaffolding.md` - First story
- `.github/issues/STORY-003-ble-service-layer.md` - Complex story example
- `.github/issues/STANDALONE-BLE-PROXY-SERVICE.md` - Bonus feature

**Label System:**
- Priority: `p0`, `p1`, `p2`, `p3`
- Type: `epic`, `story`, `enhancement`, `bug`, `documentation`
- Phase: `phase-1-foundation`, `phase-2-core-ble`, etc.
- Component: `ble`, `ui`, `api`, `testing`, `deployment`
- Status: `status:todo`, `status:in-progress`, `status:blocked`, `status:review`, `status:done`

**Documentation:**
- [GitHub Issues Guide](GITHUB_ISSUES_GUIDE.md)

## üì¶ Deliverables

### New Documents Created (9 total)

1. **[NEXTJS_REWRITE_EPIC.md](NEXTJS_REWRITE_EPIC.md)** - Complete epic plan (25 stories, 7 phases) ‚úÖ Updated with feature flags
2. **[NEXTJS_REWRITE_SUMMARY.md](NEXTJS_REWRITE_SUMMARY.md)** - Quick reference TL;DR ‚úÖ Updated
3. **[NEXTJS_FILE_STRUCTURE.md](NEXTJS_FILE_STRUCTURE.md)** - Migration mapping (old ‚Üí new)
4. **[NEXTJS_ROADMAP.md](NEXTJS_ROADMAP.md)** - Visual timeline and burndown
5. **[STANDALONE_BLE_PROXY_SERVICE.md](STANDALONE_BLE_PROXY_SERVICE.md)** - Bonus feature spec ‚ú® NEW
6. **[GITHUB_ISSUES_GUIDE.md](GITHUB_ISSUES_GUIDE.md)** - How to create and manage issues ‚ú® NEW
7. **[UPDATES_2025_11_02.md](UPDATES_2025_11_02.md)** - This document ‚ú® NEW

### GitHub Issue Templates (3 total)

8. **[.github/ISSUE_TEMPLATE/epic.yml](.github/ISSUE_TEMPLATE/epic.yml)** - Epic template ‚ú® NEW
9. **[.github/ISSUE_TEMPLATE/story.yml](.github/ISSUE_TEMPLATE/story.yml)** - Story template ‚ú® NEW
10. **[.github/ISSUE_TEMPLATE/config.yml](.github/ISSUE_TEMPLATE/config.yml)** - Config ‚ú® NEW

### Example Issue Markdown (4 total)

11. **[.github/issues/EPIC-001-nextjs-rewrite.md](.github/issues/EPIC-001-nextjs-rewrite.md)** ‚ú® NEW
12. **[.github/issues/STORY-001-project-scaffolding.md](.github/issues/STORY-001-project-scaffolding.md)** ‚ú® NEW
13. **[.github/issues/STORY-003-ble-service-layer.md](.github/issues/STORY-003-ble-service-layer.md)** ‚ú® NEW
14. **[.github/issues/STANDALONE-BLE-PROXY-SERVICE.md](.github/issues/STANDALONE-BLE-PROXY-SERVICE.md)** ‚ú® NEW

## üéØ Epic Scope

### 25 Core Stories (125 story points)
1. **Phase 1: Foundation** (5 stories, 21 pts) - Weeks 1-2
2. **Phase 2: Core BLE** (5 stories, 29 pts) - Weeks 3-4
3. **Phase 3: Module Library** (3 stories, 16 pts) - Weeks 5-6
4. **Phase 4: Features** (4 stories, 21 pts) - Weeks 7-8
5. **Phase 5: Standalone Deploy** (2 stories, 10 pts) - Week 9
6. **Phase 6: Appwrite Deploy** (4 stories, 18 pts) - Weeks 10-11
7. **Phase 7: Polish** (2 stories, 10 pts) - Week 12

### 1 Bonus Feature (5-8 story points)
- **Standalone BLE Proxy Service** - Enables iOS users on Appwrite UI

**Total:** 26 features, 130-133 story points, 12 weeks

## üöÄ Next Steps

### Immediate (This Week)

1. **Review the epic plan:**
   - Read [NEXTJS_REWRITE_EPIC.md](NEXTJS_REWRITE_EPIC.md)
   - Review [STANDALONE_BLE_PROXY_SERVICE.md](STANDALONE_BLE_PROXY_SERVICE.md)
   - Check [GITHUB_ISSUES_GUIDE.md](GITHUB_ISSUES_GUIDE.md)

2. **Create GitHub issues:**
   - Copy `.github/issues/EPIC-001-nextjs-rewrite.md` ‚Üí create issue
   - Note the epic issue number (e.g., #123)
   - Use issue templates or markdown files to create all 26 stories
   - Link dependencies (`Depends on: #XXX`, `Blocks: #XXX`)
   - Add labels (priority, phase, component)

3. **Set up labels in GitHub:**
   ```bash
   # Priority labels
   gh label create p0 --color FF0000 --description "Blocker"
   gh label create p1 --color FF9900 --description "High priority"
   gh label create p2 --color FFCC00 --description "Medium priority"
   gh label create p3 --color 00CC00 --description "Low priority"

   # Type labels
   gh label create epic --color 5319E7 --description "Parent epic"
   gh label create story --color 0075CA --description "User story"

   # Phase labels
   gh label create phase-1-foundation --color D4C5F9
   gh label create phase-2-core-ble --color C2E0C6
   # ... (see guide for all)
   ```

### Week 1 (Kickoff)

4. **Start STORY-001: Project Scaffolding:**
   - Clone shadcn/ui starter template
   - Set up TypeScript strict mode
   - Create folder structure
   - Configure feature flags
   - Write initial README

5. **Parallel work (if 2+ developers):**
   - Developer A: STORY-001 (scaffolding)
   - Developer B: STORY-002 (API client) - can start in parallel

### Ongoing

6. **Weekly sprint planning:**
   - Review completed stories
   - Calculate velocity
   - Plan next week's stories
   - Update epic issue with progress

7. **Track progress:**
   - Update issue task lists (check boxes)
   - Add `status:*` labels
   - Comment on blockers
   - Link PRs to issues (`Closes #XXX`)

## üìä Key Metrics to Track

- **Story Points Completed** (target: 10-12 per week)
- **Velocity** (calculate after week 2)
- **Stories Completed** (0 / 26)
- **Blockers** (should be zero or resolved quickly)
- **Test Coverage** (target: 80%+)

## üîÑ Changes from Original Plan

| Aspect | Original | Updated |
|--------|----------|---------|
| Branch strategy | Separate branches | Single branch + feature flags |
| Tracking | GitHub Project Board | GitHub Issues with dependencies |
| Total stories | 25 | 26 (added BLE proxy bonus) |
| Deployment modes | Standalone OR Appwrite | Standalone, Appwrite, OR Hybrid |
| Story points | 125 | 130-133 |

## üìö Documentation Index

### Planning Documents
- [NEXTJS_REWRITE_EPIC.md](NEXTJS_REWRITE_EPIC.md) - **Start here!** Complete epic
- [NEXTJS_REWRITE_SUMMARY.md](NEXTJS_REWRITE_SUMMARY.md) - Quick summary
- [NEXTJS_ROADMAP.md](NEXTJS_ROADMAP.md) - Visual timeline
- [GITHUB_ISSUES_GUIDE.md](GITHUB_ISSUES_GUIDE.md) - Issue management guide

### Architecture & Migration
- [NEXTJS_FILE_STRUCTURE.md](NEXTJS_FILE_STRUCTURE.md) - File structure mapping
- [STANDALONE_BLE_PROXY_SERVICE.md](STANDALONE_BLE_PROXY_SERVICE.md) - BLE proxy spec

### Issue Templates
- [.github/ISSUE_TEMPLATE/epic.yml](.github/ISSUE_TEMPLATE/epic.yml) - Epic template
- [.github/ISSUE_TEMPLATE/story.yml](.github/ISSUE_TEMPLATE/story.yml) - Story template

### Example Issues
- [.github/issues/EPIC-001-nextjs-rewrite.md](.github/issues/EPIC-001-nextjs-rewrite.md) - Parent epic
- [.github/issues/STORY-001-project-scaffolding.md](.github/issues/STORY-001-project-scaffolding.md) - Story example
- [.github/issues/STORY-003-ble-service-layer.md](.github/issues/STORY-003-ble-service-layer.md) - Complex story
- [.github/issues/STANDALONE-BLE-PROXY-SERVICE.md](.github/issues/STANDALONE-BLE-PROXY-SERVICE.md) - Bonus feature

## ‚ùì FAQ

### Q: Why feature flags instead of branches?
**A:** Single source of truth, no divergence, easier to maintain, CI/CD builds both modes from same code.

### Q: Can we change the scope?
**A:** Freeze scope after Phase 4 (week 8). New ideas go into backlog for future epics.

### Q: What if we fall behind?
**A:** Track velocity, adjust estimates, consider dropping P2 stories (community features, import/export).

### Q: When should we build the standalone BLE proxy?
**A:** After STORY-020 (Appwrite Auth Setup). It's a bonus feature, not blocking.

### Q: How do we handle blockers?
**A:** Add `status:blocked` label, comment with blocker issue, notify team, work on unblocked stories in parallel.

## üéâ Ready to Start!

All planning documents, issue templates, and architectural specs are ready. The next step is to create the GitHub issues and kick off STORY-001!

---

**Created:** 2025-11-02
**Author:** Claude (Assistant)
**Version:** 2.0 (feature flags + BLE proxy + GitHub issues)
**Status:** ‚úÖ Complete and ready for implementation
